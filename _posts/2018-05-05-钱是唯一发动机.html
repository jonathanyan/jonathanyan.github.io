<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
</head>
<body>
<p>钱是唯一发动机</p>

<p>给比特币加智能合同 之三</p>

<p>话说某大人物，社会贤达政协委员那种的，电视里常见。某天独上酒楼，看到一个抱着琵琶的妞，生面孔，清秀脱俗，颇有几分姿色，心里暗赞，脱口而出：妞，给大爷唱一个。小姑娘来了脾气，头微扬，话里夹着气儿：姐今儿不唱了。</p>

<p>大人物一怔，立马调整过来：以前打情骂俏的，知道自己的身份，今儿这位新来，不知道大爷我的身价。随即拍出一叠钞票……</p>

<p>故事打住。在信用无法准确传递的网络协作中，唯有钱，只有钱，才能即触即发个人的热情。这是中本聪让交易先行的理念基础。</p>

<p>如果拽点哲学，姑且套用华叔（叔本华） 的意志和表象：互联网让本已表象重叠的人世多了一层更大更空的虚象，钱成了意志的唯一表达。</p>

<p>很干净很纯洁的思想。但区块链2.0以太坊迅速与世俗拥抱，合同是中心化的帮凶。自称区块链3.0的EOS天生带有巴结基因，21个超级节点为权贵预留。没有温州商帮的底气，别碰那些“超级”。</p>

<p>当然，堕落有快感，世俗有欢乐。EOS的做法适合中国国情，在那块土壤中很有可能成功。</p>

<p>扯回合同。给比特币加智能合同，是一种有情怀的堕落。那情怀要保留几分呢？</p>

<p>首先，不能让“合同发起交易”，交易的至上地位是比特币的根基，动什么也不能动根基。合同只能当二等公民。如果合同一定要用到钱（coin），必须从“钱”出发走到“合同”，即“交易驱动合同”。</p>

<p>一般的，钱有存（deposit）和取（withdraw）两种操作。deposit简单，钱先打到合同名下，合同按钱推进。</p>

<p>withdraw复杂些，不得不分两步走。先由个人请求或合同触发一个WithdrawRequest，生成挂单，放进流水，状态是pending。随后合同拥有者的增强钱包收到请款通知，自动或手动发起“买单”交易WithdrawConfirm，把状态从pending改成finished。</p>

<p>这个方案无需改变虚拟机，目前存款要求的payable修饰字依然支持，但取款的send关键字不再起作用，改由合同协议（比如ERC20的增强版）和钱包相结合的两个接口WithdrawRequest 和 WithdrawConfirm 来实现。这样最大限度地保留了与现有以太坊生态圈的兼容：新协议可以运行在老生态中，老协议需要做少量更改能进入新环境。</p>

<p>在完好保住了比特币的“交易第一”原则后，该考虑安全性了。“打一枪换一地”的地址变换依然支持。</p>

<p>赌徒下赌场，可以用身份A玩两轮老虎机，再用身份B走五圈德州扑克，结账时，要求赌场老板将余额转到身份C中。在不断的变换中，中纪委能力再强，也查不出参赌的个人身份和金钱流向。</p>

<p>拍卖不需要规定一人一账户。只要钱多，一个人可以用身份甲和身份乙同时上阵，做托做局，任由己便。</p>

<p>最重要的是，合同拥有人在还款时，能用不同地址给不同人打钱，分离合同拥有者和合同还款人。只要有人负责买单，谁买who care。</p>

<p>在这种设计中，合同保护了拥有人和参与人的隐私，必然将智能合同带入更皮实的合作空间。颠覆比特币在合同里的霸主地位，可期！</p>

<p>享受世俗的同时一直揣着诗和远方，能入能离，能进能出，是境界 &#8212;&#8211; 智能合同在比特币框架下可以做到。</p>

<p>博客收录于 https://jonathanyan.github.io</p>

</body>
</html>